@{
    Layout = "~/views/shared/_Layout.cshtml";
}


<div id="insights">
    <h1>{{title}}</h1>
    <div v-html="msgBox"></div>
    <div class="row mb-4">
        <div class="col-md-6">
            <div class="form-group">
                <label class="control-label">Type</label>
                <select asp-items="ViewBag.types" v-model.number="typeId" class="form-control">
                    <option value="0">None</option>
                </select>
            </div>
            <div class="form-group">
                <label class="control-label">Status</label>
                <select asp-items="ViewBag.types" v-model.number="statusId" class="form-control">
                    <option value="-90">None</option>
                </select>
            </div>
        </div>
        <div class="col-md-3">
            <form v-on:submit.prevent="search(true);" method="post">
                <div class="input-group">
                    <input class="form-control" type="search" v-model="keywords" placeholder="search by title">
                    <div class="input-group-append ">
                        <button type="button" class="btn btn-secondary" v-on:click="search(true)">Search</button>
                    </div>
                </div>
            </form>
        </div>
        <div class="col-md-3 text-right">
            <a class="btn btn-primary" href='@Url.Action("details")'>Create Insight</a>

        </div>
    </div>

    <table class="table">
        <thead class="thead-blue">
            <tr>
                <th><input type="checkbox" v-model="selectAll" v-on:change="selectionChange()" /></th>
                <th>
                    ID
                </th>
                <th>
                    Title
                </th>
                <th v-if="typeId == 0">
                    Type
                </th>
                <th v-if="statusId == -90">
                    Status
                </th>
                <th>
                    src
                </th>
                <th>
                    Link
                </th>
                <th></th>
            </tr>
        </thead>
        <tbody>
            <tr v-for="insight of displayedInsights">
                <td><input type="checkbox" class="chk" v-model.number="recs" name="recs" :value="insight.id" /></td>
                <td>
                    {{ insight.id }}
                </td>
                <td>
                    {{ insight.title }}
                </td>
                <td v-if="typeId == 0">
                    {{ insight.ref_InsightType.name }}
                </td>
                <td v-if="statusId == -90">
                    {{ insight.ref_Statuses.name }}
                </td>
                <td>
                    {{ insight.src }}
                </td>
                <td>
                    {{ insight.link }}
                </td>
                <td class="text-right">
                    <a :href="package.bookingUrl" target="_blank" class="btn btn-outline-secondary btn-sm mr-3" title="Preview"><i class="fa fa-eye"></i></a>
                    <div class="btn-group btn-group-sm">
                        <a :href="`javascript:confirmDeleteRecord('${insight.title}','${insight.id}')`" class="btn btn-outline-secondary btn-sm" title="Delete" id="package.id"><i class="fa fa-trash"></i></a>
                        <a :href="'snn_Insights/details/' + insight.id" class="btn btn-secondary" title="Edit"><i class="fa fa-edit"></i></a>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>

    <div id="MyPopup" class="py-4 text-center actionButtons fixed-bottom bg-black-opacity50" :style="showactionBar()">
        <div class="form-inline">
            <div class="input-group mx-auto">
                <select class="form-control" v-model="action">
                    <option value="delete">Delete Selected</option>
                </select>
                <div class="input-group-append">
                    <button id="Button1" v-on:click="takeAction()" class="btn btn-primary">Go</button>
                </div>
            </div>
        </div>
    </div>
</div>
<script>
    insightsListData = @Html.Raw(ViewData["insights"]);
</script>
<script src="/js/insights.js"></script>